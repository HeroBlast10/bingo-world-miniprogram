<!--pages/game/game.wxml-->
<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading" wx:if="{{isLoading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- æ¸¸æˆå†…å®¹ -->
  <view class="game-content" wx:else>
    <!-- æ¸¸æˆå¤´éƒ¨ä¿¡æ¯ -->
    <view class="game-header" wx:if="{{game}}">
      <!-- å°ç¨‹åºæ ‡è¯† -->
      <text class="app-brand">å°ç¨‹åº@å®¾äº†ä¸ªæœ</text>
      <!-- æ˜¾ç¤ºæ¸¸æˆæ ‡é¢˜å’Œæè¿° -->
      <text class="game-title">{{game.title}}</text>
      <text class="game-description" wx:if="{{game.description && game.description.trim() !== '' && game.description !== 'äº”ä¸ªè¿æˆä¸€çº¿...'}}">
        {{game.description}}
      </text>
    </view>

    <!-- å®¾æœç½‘æ ¼ -->
    <view class="bingo-container" wx:if="{{game}}">
      <view class="grid-container">
        <!-- ä½¿ç”¨ä¸¤å±‚åµŒå¥—çš„ wx:for æ¥éå† game.gridContent -->
        <!-- å¤–å±‚ wx:for-index ä¸º rowIndex -->
        <view
          class="grid-row"
          wx:for="{{game.gridContent}}"
          wx:for-index="rowIndex"
          wx:key="rowIndex"
        >
          <!-- å†…å±‚ä¸º colIndex -->
          <view
            class="cell {{selectedCells[rowIndex][colIndex] ? 'selected selected-' + selectedColor : ''}}"
            wx:for="{{item}}"
            wx:for-index="colIndex"
            wx:key="colIndex"
            data-row-index="{{rowIndex}}"
            data-col-index="{{colIndex}}"
            bindtap="handleCellClick"
          >
            <!-- æ˜¾ç¤ºå•å…ƒæ ¼æ–‡æœ¬ -->
            <text class="cell-text {{item.textSizeClass}}">{{item.text}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- åº•éƒ¨å¯¼èˆªæ  -->
    <view class="bottom-nav" wx:if="{{game}}">
      <view class="nav-item" bindtap="onSaveGame">
        <view class="nav-icon">ğŸ’¾</view>
        <text class="nav-text">ä¿å­˜</text>
      </view>
      <view class="nav-item" bindtap="onDownloadGame">
        <view class="nav-icon">ğŸ“¥</view>
        <text class="nav-text">ä¸‹è½½</text>
      </view>
      <view class="nav-item" bindtap="onShareGame">
        <view class="nav-icon">ğŸ“¤</view>
        <text class="nav-text">åˆ†äº«</text>
      </view>
    </view>

    <!-- éšè—çš„canvasç”¨äºç”Ÿæˆå›¾ç‰‡ -->
    <canvas
      canvas-id="bingoCanvas"
      class="hidden-canvas"
      style="width: 750px; height: 1000px; position: absolute; left: -9999px; top: -9999px;"
    ></canvas>
  </view>
</view>